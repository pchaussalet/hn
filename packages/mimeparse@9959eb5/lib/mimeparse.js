function parseRanges(e){for(var t=[],n=e.split(","),i=0;n.length>i;i++)t.push(exports.parseMediaRange(n[i]));return t}exports.parseMimeType=function(e){for(var t,n,i={},r=e.split(";"),a=0;r.length>a;a++){var o=r[a].split("=");2===o.length&&(i[o[0].trim()]=o[1].trim())}return t=r[0].replace(/^\s+/,"").replace(/\s+$/,""),"*"===t&&(t="*/*"),n=t.split("/"),[n[0],n[1],i]},exports.parseMediaRange=function(e){var t,n=exports.parseMimeType(e);return n[2].q?(t=parseFloat(n[2].q),isNaN(t)?n[2].q="1":(t>1||0>t)&&(n[2].q="1")):n[2].q="1",n},exports.fitnessAndQualityParsed=function(e,t){for(var n=-1,i=0,r=exports.parseMediaRange(e),a=r[0],o=r[1],s=r[2],l=0;t.length>l;l++){var c=t[l],u=c[0],h=c[1],d=c[2];if(!(u!==a&&"*"!==u&&"*"!==a||h!==o&&"*"!==h&&"*"!==o)){var p=0;for(var f in s)"q"!==f&&d[f]&&d[f]===s[f]&&(p+=1);var g=u===a?100:0;g+=h===o?10:0,g+=p,g>n&&(n=g,i=d.q)}}return[n,parseFloat(i)]},exports.qualityParsed=function(e,t){return exports.fitnessAndQualityParsed(e,t)[1]},exports.quality=function(e,t){return exports.qualityParsed(e,parseRanges(t))},exports.bestMatch=function(e,t){for(var n=parseRanges(t),i=[],r=0;e.length>r;r++)i.push([exports.fitnessAndQualityParsed(e[r],n),e[r]]);return i.sort(),i[i.length-1][0][1]?i[i.length-1][1]:""};