"undefined"!=typeof window&&("ontouchstart"in window||(window.Touch=null),document._montageTiming={},document._montageTiming.loadStartTime=Date.now(),window.addEventListener("DOMContentLoaded",function(){var t=1e3;document._montageStartBootstrappingTimeout=setTimeout(function(){document._montageStartBootstrappingTimeout=null;var t=document.documentElement;t.classList?t.classList.add("montage-app-bootstrapping"):t.className=t.className+" montage-app-bootstrapping",document._montageTiming.bootstrappingStartTime=Date.now()},t)})),function(t){"undefined"!=typeof require?t.call("undefined"!=typeof global?global:this,require,exports,module):t({},{},{})}(function(t,e){global=this,e.initMontage=function(){var t=e.getPlatform();t.bootstrap(function(n,i,r){var a=t.getParams(),s={location:n.getLocation()},l=r.resolve(s.location,a.montageLocation);s.moduleTypes=["html","meta"],s.makeLoader=function(t){return e.ReelLoader(t,n.makeLoader(t))},s.makeCompiler=function(t){return e.MetaCompiler(t,e.SerializationCompiler(t,e.TemplateCompiler(t,n.makeCompiler(t))))};var c=r.resolve(s.location,a["package"]||"."),u=a.applicationHash;if("object"==typeof BUNDLE){var h={},d=function(t){return h[t]=h[t]||i.defer()};global.bundleLoaded=function(t){d(t).resolve()};var p=i.defer();s.preloaded=p.promise;var f=i.resolve();BUNDLE.forEach(function(t){f=f.then(function(){return i.all(t.map(function(t){return o.load(t),d(t).promise}))})}),p.resolve(f.then(function(){delete BUNDLE,delete bundleLoaded}))}var g;if("remoteTrigger"in a){var v=i.defer();window.postMessage({type:"montageReady"},"*");var m=function(t){if(a.remoteTrigger===t.origin&&(t.source===window||t.source===window.parent))switch(t.data.type){case"montageInit":window.removeEventListener("message",m),v.resolve([t.data.location,t.data.injections]);break;case"isMontageReady":window.postMessage({type:"montageReady"},"*")}};window.addEventListener("message",m),g=v.promise.spread(function(t,e){var i=n.loadPackage({location:t,hash:u},s);return e&&(i=i.then(function(n){t=r.resolve(t,".");var i,a,o=e.packageDescriptions,s=e.packageDescriptionLocations,l=e.mappings,c=e.dependencies;if(o)for(a=o.length,i=0;a>i;i++)n.injectPackageDescription(o[i].location,o[i].description);if(s)for(a=s.length,i=0;a>i;i++)n.injectPackageDescriptionLocation(s[i].location,s[i].descriptionLocation);if(l)for(a=l.length,i=0;a>i;i++)n.injectMapping(l[i].dependency,l[i].name);if(c)for(a=c.length,i=0;a>i;i++)n.injectDependency(c[i].name,c[i].version);return n})),i})}else{if("autoPackage"in a)n.injectPackageDescription(c,{dependencies:{montage:"*"}},s);else if(".json"===c.slice(c.length-5)){var b=c;c=r.resolve(c,"."),n.injectPackageDescriptionLocation(c,b,s)}g=n.loadPackage({location:c,hash:u},s)}g.then(function(e){e.loadPackage({location:l,hash:a.montageHash}).then(function(t){var e;return e=a.promiseLocation?r.resolve(n.getLocation(),a.promiseLocation):r.resolve(l,"packages/mr/packages/q"),[t,t.loadPackage({location:e,hash:a.promiseHash})]}).spread(function(n,o){n.inject("core/mini-url",r),n.inject("core/promise",{Promise:i}),o.inject("q",i),s.lint=function(t){n.async("core/jshint").then(function(e){e.JSHINT(t.text)||(console.warn("JSHint Error: "+t.location),e.JSHINT.errors.forEach(function(t){t&&(console.warn("Problem at line "+t.line+" character "+t.character+": "+t.reason),t.evidence&&console.warn("    "+t.evidence))}))}).done()},self.require=self.mr=e,t.initMontage(n,e,a)})}).done()})};var n=/((.*)\.reel)\/\2$/,i=function(t,e){return e};e.SerializationCompiler=function(t,e){return function(t){if(e(t),t.factory){var r=t.factory;return t.factory=function(t,e,a){r.call(this,t,e,a);for(var o in e){var s=e[o];if(s instanceof Object){if(s.hasOwnProperty("_montage_metadata")&&!s._montage_metadata.isInstance)s._montage_metadata.aliases.push(o),s._montage_metadata.objectName=o;else if(!Object.isSealed(s)){var l=a.id.replace(n,i);Object.defineProperty(s,"_montage_metadata",{value:{require:t,module:l,moduleId:l,property:o,objectName:o,aliases:[o],isInstance:!1}})}}else;}},t}}};var r=/([^\/]+)\.reel$/;e.ReelLoader=function(t,e){return function(t,n){var i=r.exec(t);return i?(n.redirect=t+"/"+i[1],n):e(t,n)}};var a=/\.meta/;e.MetaCompiler=function(t,e){return function(t){var n=(t.location||"").match(a);return n?(t.exports=JSON.parse(t.text),t):e(t)}},e.TemplateCompiler=function(t,e){return function(t){if(t.location){var n=t.location.match(/(.*\/)?(?=[^\/]+\.html(?:\.load\.js)?$)/);return n?(t.dependencies=t.dependencies||[],t.exports={directory:n[1],content:t.text},Object.defineProperty(t.exports,"root",{get:function(){return"object"==typeof console&&console.warn("'root' property is deprecated on template modules.  Use 'directory' instead of root[1]"),n}}),t):(e(t),void 0)}}},e.getPlatform=function(){if("undefined"!=typeof window&&window&&window.document)return o;if("undefined"!=typeof process)return t("./node.js");throw Error("Platform not supported.")};var o={makeResolve:function(){var t=document.querySelector("head"),e=document.createElement("base"),n=document.createElement("a");return e.href="",function(i,r){var a=t.querySelector("base");if(a||(t.appendChild(e),a=e),i+="",!/^[\w\-]+:/.test(i))throw Error("Can't resolve from a relative location: "+JSON.stringify(i)+" "+JSON.stringify(r));var o=a.href;a.href=i,n.href=r;var s=n.href;return a.href=o,a===e&&t.removeChild(a),s}},load:function(t){var e=document.createElement("script");e.src=t,e.onload=function(){e.parentNode.removeChild(e)},document.getElementsByTagName("head")[0].appendChild(e)},getParams:function(){var t,e,n,i,r,a,o;if(!this._params){this._params={};var s=document.getElementsByTagName("script");for(t=0;s.length>t;t++)if(i=s[t],r=!1,i.src&&(n=i.src.match(/^(.*)montage.js(?:[\?\.]|$)/i))&&(this._params.montageLocation=n[1],r=!0),i.hasAttribute("data-montage-location")&&(this._params.montageLocation=i.getAttribute("data-montage-location"),r=!0),r){if(i.dataset)for(o in i.dataset)this._params[o]=i.dataset[o];else if(i.attributes){var l=/-([a-z])/g,c=function(t,e){return e.toUpperCase()};for(e=0;i.attributes.length>e;e++)a=i.attributes[e],n=a.name.match(/^data-(.*)$/),n&&(this._params[n[1].replace(l,c)]=a.value)}i.parentNode.removeChild(i);break}}return this._params},bootstrap:function(t){function e(){document.removeEventListener("DOMContentLoaded",e,!0),s=!0,r()}function n(t){if(!v[t]&&g[t]){var e=v[t]={};v[t]=g[t](n,e)||e}return v[t]}function i(){c=n("mini-url"),l=n("promise"),a=n("require"),delete global.bootstrap,r()}function r(){s&&a&&t(a,l,c)}var a,s,l,c,u=this.getParams(),h=this.makeResolve();/interactive|complete/.test(document.readyState)?e():document.addEventListener("DOMContentLoaded",e,!0);var d={require:"packages/mr/require.js","require/browser":"packages/mr/browser.js",promise:"packages/mr/packages/q/q.js"};if("undefined"==typeof BUNDLE){var p=h(window.location,u.montageLocation);for(var f in d)o.load(h(p,d[f]))}var g={};global.bootstrap=function(t,e){g[t]=e,delete d[t];for(var t in d)return;delete global.bootstrap,i()},global.bootstrap("mini-url",function(t,e){e.resolve=h});var v={}},initMontage:function(t,e,n){var i=["core/core","core/event/event-manager","core/serialization/deserializer/montage-reviver","core/logger","core/deprecate"],r=t("core/promise").Promise;return r.all(i.map(t.deepLoad)).then(function(){i.forEach(t),t("core/core").Montage;var a,o,s=t("core/event/event-manager").EventManager,l=t("core/serialization/deserializer/montage-reviver").MontageReviver,c=t("core/logger").logger,u=t("core/deprecate");c("Promise stacktrace support",function(t){r.longStackSupport=!!t}),a=(new s).initWithWindow(window),"function"==typeof global.montageWillLoad&&global.montageWillLoad();var h,d,p=e.packageDescription.applicationPrototype;return p?(h=l.parseObjectLocationId(p),d=e.async(h.moduleId)):d=t.async("core/application"),d.then(function(t){var i=t[h?h.objectName:"Application"];o=new i,Object.defineProperty(window.document,"application",{get:u.deprecateMethod(null,function(){return t.application},'document.application is deprecated, use require("montage/core/application").application instead.')}),a.application=o,o.eventManager=a,o._load(e,function(){n.module&&e.async(n.module).done(),"function"==typeof global.montageDidLoad&&global.montageDidLoad()})})}).done()}};"undefined"!=typeof window?global.__MONTAGE_LOADED__?console.warn("Montage already loaded!"):(global.__MONTAGE_LOADED__=!0,e.initMontage()):e.getPlatform()});