var Component=require("../component").Component,ModalOverlay=require("../modal-overlay.reel").ModalOverlay,Promise=require("../../core/promise").Promise;exports.AbstractAlert=Component.specialize({constructor:{value:function AbstractAlert(){if(this.constructor===AbstractAlert)throw Error("AbstractAlert cannot be instantiated.")}},_overlay:{value:null},_okButton:{value:null},_userActionDeferred:{value:null},title:{value:"Alert"},okLabel:{value:"OK"},message:{value:null},enterDocument:{value:function(t){var e;t&&(e=Object.getPrototypeOf(this).constructor,this===e._instance&&e._nextMessageDeferred.resolve(),this._okButton.addEventListener("action",this,!1))}},show:{value:function(){return this._userActionDeferred||(this._overlay.hasModalMask=!1,this._overlay.show(),this._userActionDeferred=Promise.defer()),this._userActionDeferred.promise}},handleAction:{value:function(t){t.target===this._okButton&&(this._userActionDeferred.resolve(),this._userActionDeferred=null,this._overlay.hide())}}},{_instance:{value:null},__nextMessageDeferred:{value:null},_nextMessageDeferred:{get:function(){return this.hasOwnProperty("__nextMessageDeferred")||(this.__nextMessageDeferred=Promise.defer()),this.__nextMessageDeferred}},__nextMessagePromise:{value:null},_nextMessagePromise:{set:function(t){this.__nextMessagePromise=t},get:function(){return this.hasOwnProperty("__nextMessagePromise")||(this.__nextMessagePromise=this._nextMessageDeferred.promise),this.__nextMessagePromise}},_setupInstance:{value:function(){var t;t=this._instance=new this,t.element=t.rootComponent.element.createElement("div"),t.element.ownerDocument.body.appendChild(t.element),t.attachToParentComponent(),t.needsDraw=!0}},show:{value:function(t,e){var n,i=this;return this.hasOwnProperty("_instance")||this._setupInstance(),n=this._instance,this._nextMessagePromise=this._nextMessagePromise.then(function(){return n.title=e?e:i.prototype.title,n.message=t,n.show()})}}});