montageDefine("b52e2a0","ui/base/abstract-video",{dependencies:["../../core/core","../component","../../core/media-controller"],factory:function(t,e){var n=t("../../core/core").Montage,i=t("../component").Component,r=t("../../core/media-controller").MediaController,a=e.AbstractVideo=i.specialize({constructor:{value:function a(){if(this.constructor===a)throw Error("AbstractVideo cannot be instantiated.");i.constructor.call(this)}},_mediaElement:{value:null},mediaElement:{get:function(){return this._mediaElement},set:function(t){this._mediaElement&&(this._mediaElement.controller=null),this._mediaElement=t,this.videoController&&(this._mediaElement.controller=this.videoController.mediaController)}},_videoController:{value:null},videoController:{get:function(){return this._videoController},set:function(t){t&&(this._videoController=t,this.mediaElement&&(this.mediaElement.controller=t.mediaController))}},_src:{value:null},src:{get:function(){return this._src},set:function(t){this._src=t}},_sources:{value:[]},sources:{get:function(){return this._sources},set:function(t){if(t&&t.length){for(var e=this.element.ownerDocument.createElement("video"),n=0;t.length>n;n++){var i=t[n].src,r=t[n].type;if(r&&e.canPlayType(r)){this.src=i;break}}this._sources=t}}},loadMedia:{value:function(){this.mediaElement.src=this.src,this.mediaElement.load()}},_repeat:{value:!1},repeat:{get:function(){return this._repeat},set:function(t){t!==this._repeat&&(this._repeat=t,t?this.mediaElement.setAttribute("loop","true"):this.mediaElement.removeAttribute("loop"),this.needsDraw=!0)}},toggleRepeat:{value:function(){this.repeat=!this.repeat}},_posterSrc:{value:null},posterSrc:{get:function(){return this._posterSrc},set:function(t){this._posterSrc=t}},showPoster:{value:function(){this.posterSrc&&this.mediaElement&&(this.mediaElement.poster=this.posterSrc)}},supportsFullScreen:{value:!0},_isFullScreen:{value:!1},isFullScreen:{get:function(){return this._isFullScreen}},toggleFullScreen:{value:function(){this.supportsFullScreen&&(this._isFullScreen=!this._isFullScreen,this._isFullScreen?this.element.webkitEnterFullScreen?this.element.webkitEnterFullScreen():this.element.webkitRequestFullScreen&&this.element.webkitRequestFullScreen():this.element.webkitExitFullscreen?this.element.webkitExitFullscreen():this.element.webkitCancelFullScreen?this.element.webkitCancelFullScreen():this.element.ownerDocument.webkitCancelFullScreen&&this.element.ownerDocument.webkitCurrentFullScreenElement===this.element&&this.element.ownerDocument.webkitCancelFullScreen(),this.needsDraw=!0)}},handleControllerStatusChange:{value:function(){this.needsDraw=!0}},handleControllerVolumeChange:{value:function(){this.needsDraw=!0}},enterDocument:{value:function(t){if(t){if(this.originalElement.hasAttribute("src")&&this.originalElement.getAttribute("src"))this.src=this.originalElement.getAttribute("src");else for(var e,i,a=this.originalElement.getElementsByTagName("source"),o=0;a.length>o;o++)if(e=a[o].getAttribute("src"),i=a[o].getAttribute("type"),!i||this.mediaElement.canPlayType(i)){this.src=e;break}for(var s=this.originalElement.getElementsByTagName("track"),o=0;s.length>o;o++){var l=s[o].getAttribute("kind");if("captions"==l||"subtitles"==l){var c=document.createElement("track");c.kind=l,c.label=s[o].getAttribute("label"),c.src=s[o].getAttribute("src"),c.srclang=s[o].getAttribute("srclang"),c.default=s[o].hasAttribute("default"),this.mediaElement.appendChild(c),this.mediaElement.textTracks[this.mediaElement.textTracks.length-1].mode="showing"}}this.addPathChangeListener("videoController.status",this,"handleControllerStatusChange"),this.addPathChangeListener("videoController.volume",this,"handleControllerVolumeChange"),this.videoController||(this.videoController=n.create(r)),this.mediaElement.controller=this.videoController.mediaController}}}})}});