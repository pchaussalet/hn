"use strict";var NodeHTTPParser=process.binding("http_parser").HTTPParser,version=NodeHTTPParser.RESPONSE?6:4,HttpParser=function(e){this._parser="request"===e?new NodeHTTPParser(NodeHTTPParser.REQUEST||"request"):new NodeHTTPParser(NodeHTTPParser.RESPONSE||"response"),this._type=e,this._complete=!1,this.headers={};var t=null,n=this;this._parser.onHeaderField=function(e,n,r){t=e.toString("utf8",n,n+r).toLowerCase()},this._parser.onHeaderValue=function(e,r,i){var a=e.toString("utf8",r,r+i);n.headers.hasOwnProperty(t)?n.headers[t]+=", "+a:n.headers[t]=a},this._parser.onHeadersComplete=this._parser[NodeHTTPParser.kOnHeadersComplete]=function(e,t,r,i,a,o){var s=arguments[0];if("object"==typeof s&&(i=s.method,a=s.url,o=s.statusCode,r=s.headers),n.method="number"==typeof i?HttpParser.METHODS[i]:i,n.statusCode=o,n.url=a,r){for(var l,c,u=0,h=r.length;h>u;u+=2)l=r[u].toLowerCase(),c=r[u+1],n.headers.hasOwnProperty(l)?n.headers[l]+=", "+c:n.headers[l]=c;n._complete=!0}}};HttpParser.METHODS={0:"DELETE",1:"GET",2:"HEAD",3:"POST",4:"PUT",5:"CONNECT",6:"OPTIONS",7:"TRACE",8:"COPY",9:"LOCK",10:"MKCOL",11:"MOVE",12:"PROPFIND",13:"PROPPATCH",14:"SEARCH",15:"UNLOCK",16:"REPORT",17:"MKACTIVITY",18:"CHECKOUT",19:"MERGE",24:"PATCH"},HttpParser.prototype.isComplete=function(){return this._complete},HttpParser.prototype.parse=function(e){var t=6>version?1:0,n=this._parser.execute(e,0,e.length)+t;this._complete&&(this.body=e.length>n?e.slice(n):new Buffer(0))},module.exports=HttpParser;